#Colores
BLUE='\033[1;36m'
NC='\033[0m'
pathdir="/usr/local/jorge/"
includes=${pathdir}"/includes/"
nameapp=""
base=""

function createIndex(){
  copy_wdir ${pathdir}index.php ${base}/index.php
  index="$(cat ${base}/index.php)"
  printf "$index" "$*" > ${base}/"index.php"
  saycreate "/index.php"
}

function createFooter(){
  footer="$(cat ${includes}partials/footer.php)"
  printf "$footer" "$*" > ${base}/"includes/partials/footer.php"
  saycreate "/includes/partials/footer.php"
}

function createHeader(){
  header="$(cat ${includes}partials/header.php)"
  printf "$header" "$*" > ${base}/"includes/partials/header.php"
  saycreate "/includes/partials/header.php"
}

function createMenu(){
  menu="$(cat ${includes}partials/menu.php)"
  printf "$menu" "$*" > ${base}/"includes/partials/menu.php"
  saycreate "/includes/partials/menu.php"
}

function createPackage(){
  package="$(cat ${pathdir}package.json)"
  printf "$package" "$*" > ${base}/"package.json"
  saycreate "/package.json"
}

function moveFiles(){
  #copy_wdir ${pathdir}.htaccess ${base}/.htaccess
  #copy_wdir ${pathdir}package.json ${base}/package.json
  copy_wdir ${pathdir}includes ${base}/includes
  copy_wdir ${pathdir}public ${base}/public
}

function borrarpantalla(){
  clear
}

function new(){
  printf 'Enter your App name: '
  read -r nameapp
  base=${PWD}/${nameapp}
  moveFiles
  stylus $nameapp/public/css/dev/styles.styl &> /dev/null
  #createPackage $nameapp
  cd $nameapp
  #echo "\t${BLUE}Installing${NC} : dependencies"
  #npm install &> /dev/null
  #grunt &> /dev/null
  #echo "\t${BLUE}Running${NC} : grunt"
  sleep 0.5
  createIndex $nameapp
  createHeader $nameapp
  createMenu $nameapp
  createFooter $nameapp
}

function create(){
  vista="$(cat ${pathdir}vista.php)"
  sleep 0.5
  touch ${1}.php
  printf "$vista" "$*" > ${1}".php"
  saycreate ${view}".php"
}

function copy_wdir() {
  mkdir -p -- "$(dirname -- "$2")" && cp -R "$1" "$2" ;
}


saycreate(){
  echo "\t${BLUE}create${NC} : ${nameapp}${1}"
  sleep 0.5
}


for parametro in $*
do
  case $parametro in
     'new')
        new
        open -a /Applications/Google\ Chrome.app 'http://localhost/'$nameapp
        atom $base
        exit 0
     ;;
     'create')
       printf 'Enter your View name: '
       read view
       create $view
      exit 0
     ;;
     'edit')
       atom /usr/local/jorge
      exit 0
     ;;
     *)
        borrarpantalla
        echo "Agregue comandos"
     ;;
  esac
done
